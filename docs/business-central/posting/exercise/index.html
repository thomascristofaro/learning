<!doctype html>
<html lang="it" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-business-central/posting/exercise" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Designing a Squash Court app | Thomas Learning</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://thomascristofaro.github.io/learning/img/thomas.png"><meta data-rh="true" name="twitter:image" content="https://thomascristofaro.github.io/learning/img/thomas.png"><meta data-rh="true" property="og:url" content="https://thomascristofaro.github.io/learning/docs/business-central/posting/exercise"><meta data-rh="true" property="og:locale" content="it"><meta data-rh="true" name="docusaurus_locale" content="it"><meta data-rh="true" name="docsearch:language" content="it"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Designing a Squash Court app | Thomas Learning"><meta data-rh="true" name="description" content="Link Codice Sorgente GitHub"><meta data-rh="true" property="og:description" content="Link Codice Sorgente GitHub"><link data-rh="true" rel="icon" href="/learning/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://thomascristofaro.github.io/learning/docs/business-central/posting/exercise"><link data-rh="true" rel="alternate" href="https://thomascristofaro.github.io/learning/docs/business-central/posting/exercise" hreflang="it"><link data-rh="true" rel="alternate" href="https://thomascristofaro.github.io/learning/docs/business-central/posting/exercise" hreflang="x-default"><link rel="stylesheet" href="/learning/assets/css/styles.30a2b5c7.css">
<script src="/learning/assets/js/runtime~main.a29a1f3c.js" defer="defer"></script>
<script src="/learning/assets/js/main.6235cb7f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Passa al contenuto principale"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Passa al contenuto principale</a></div><nav aria-label="Principale" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Attiva/disattiva la barra di navigazione" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/learning/"><div class="navbar__logo"><img src="/learning/img/avatar-sign.png" alt="Learning Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/learning/img/avatar-sign.png" alt="Learning Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Learning</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/learning/docs/business-central/Introduzione/intro">Business Central</a><a class="navbar__item navbar__link" href="/learning/docs/power-platform/intro">Power Platform</a><a class="navbar__item navbar__link" href="/learning/docs/power-apps/intro">Power Apps</a></div><div class="navbar__items navbar__items--right"><a href="https://cristofaro.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Passa dalla modalità scura a quella chiara (currently modalità luce)" aria-label="Passa dalla modalità scura a quella chiara (currently modalità luce)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Torna indietro all&#x27;inizio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Barra laterale dei documenti" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/business-central/Introduzione/intro">Introduzione</a><button aria-label="Expand sidebar category &#x27;Introduzione&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/strumenti-di-sviluppo">Strumenti di sviluppo</a><button aria-label="Expand sidebar category &#x27;Strumenti di sviluppo&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/linguaggio-al">Linguaggio AL</a><button aria-label="Expand sidebar category &#x27;Linguaggio AL&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/oggetti">Oggetti</a><button aria-label="Expand sidebar category &#x27;Oggetti&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/learning/docs/category/registrazione">Registrazione</a><button aria-label="Collapse sidebar category &#x27;Registrazione&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/docs/business-central/posting/theory">Teoria</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/learning/docs/business-central/posting/exercise">Esercizio</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/api">API</a><button aria-label="Expand sidebar category &#x27;API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/docs/business-central/copilot">Copilot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/docs/business-central/project-management">Project Management</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/business-functions">Business Functions</a><button aria-label="Expand sidebar category &#x27;Business Functions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collassa la barra laterale" aria-label="Collassa la barra laterale" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Briciole di pane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Pagina principale" class="breadcrumbs__link" href="/learning/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/learning/docs/category/registrazione"><span itemprop="name">Registrazione</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Esercizio</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Su questa pagina</button></div><div class="theme-doc-markdown markdown"><header><h1>Designing a Squash Court app</h1></header>
<p><a href="https://github.com/thomascristofaro/its-bc-posting" target="_blank" rel="noopener noreferrer">Link Codice Sorgente GitHub</a></p>
<p>Creiamo una struttura personalizzata in Microsoft Business Central. Gestiremo un&#x27;azienda che noleggia campi da squash. Per prima cosa dobbiamo definire le modifiche e le espansioni al prodotto, per farlo dobbiamo effettuare una <strong>Fit-gap analysis</strong>: esaminiamo i processi dell&#x27;azienda e definiamo cosa possiamo e cosa non possiamo fare con il pacchetto standard. Quando un processo aziendale può essere gestito con il software standard, lo chiamiamo &quot;aderente&quot; (<strong>Fit</strong>). Quando non è possibile farlo, si tratta di uno &quot;scostamento&quot; (<strong>Gap</strong>), possiamo colmare un gap sviluppando una soluzione personalizzata o acquistando un componente aggiuntivo.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="analisi">Analisi<a href="#analisi" class="hash-link" aria-label="Link diretto a Analisi" title="Link diretto a Analisi">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fit-gap-analysis">Fit-gap analysis<a href="#fit-gap-analysis" class="hash-link" aria-label="Link diretto a Fit-gap analysis" title="Link diretto a Fit-gap analysis">​</a></h4>
<p>Il processo di base di un&#x27;azienda che gestisce campi da squash consiste nel noleggio dei campi ai giocatori di squash, sia ai membri che ai non membri. Esiste un processo di prenotazione e fatturazione che gestisce tariffe diverse per i membri e i non membri.</p>
<p>In Business Central, i dati master dei clienti e dei fornitori vengono gestiti utilizzando il &quot;Relationship Management&quot; (RM). Per la nostra soluzione, creeremo una nuova master table per i giocatori di squash e saranno integrati con il RM.</p>
<p>Per progettare la tabella &quot;Squash Court&quot;, esamineremo la progettazione degli Item del pacchetto standard.
La &quot;Squash Court&quot; sarà il prodotto dell&#x27;applicazione, con un journal per creare movimenti di prenotazione, che potremo poi fatturare. Per il processo di fatturazione, utilizzeremo e integreremo la parte delle vendite di Business Central.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="posting-schema">Posting schema<a href="#posting-schema" class="hash-link" aria-label="Link diretto a Posting schema" title="Link diretto a Posting schema">​</a></h4>
<p>Dopo aver deciso quale sarà il design della nostra applicazione, possiamo disegnare le tabelle e definire le procedure di registrazione. Questo ci guiderà attraverso il processo di sviluppo.</p>
<p><img decoding="async" loading="lazy" alt="Example Posting Schema" src="/learning/assets/images/bc-posting-example-design-f7fe2125b6e27b9102e90d883c23ac39.png#center" width="488" height="312" class="img_ev3q"></p>
<p>Gli oggetti in Relationship Management e Sales sono oggetti standard che potremmo dover modificare. Gli oggetti per l&#x27;applicazione di Squash sono nuovi, ma basati su oggetti simili dello standard.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-project-approach">The Project approach<a href="#the-project-approach" class="hash-link" aria-label="Link diretto a The Project approach" title="Link diretto a The Project approach">​</a></h4>
<p>Per tenere traccia del nostro progetto, suddivideremo le modifiche in task più piccole:</p>
<ol>
<li>Modificare il Relationship Management: creare un giocatore di squash da un contatto.</li>
<li>Processo di prenotazione di un campo da squash.</li>
<li>Processo di fatturazione delle prenotazioni.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="relationship-management">Relationship Management<a href="#relationship-management" class="hash-link" aria-label="Link diretto a Relationship Management" title="Link diretto a Relationship Management">​</a></h2>
<p>Dobbiamo avere la possibilità di creare un giocatore di squash da un contatto proprio come avviene per un cliente o fornitore.
Cerchiamo di capire come funziona il metodo standard per la creazione e lo adattiamo al nostro caso d&#x27;uso.
Bisogna quindi analizzare la funzione che troviamo nella pagina <code>Contact Card</code> chiamata <code>CreateCustomer</code></p>
<p>Analizzando la funzione, vedremo che avremo bisogno di:</p>
<ul>
<li><strong>Squash Setup</strong>: Squash Player Nos. e Squash Court Nos.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Squash Setup" src="/learning/assets/images/bc-posting-image-6-e07ee86ba186e2cdbf8ee7ab5478356a.png" width="615" height="108" class="img_ev3q"></p>
<ul>
<li><strong>Squash Player</strong> master table: prendiamo la esempi dalla tabella Contact perchè c&#x27;è il transferfield + nel campo &quot;Series No.&quot; aggiungere TableRelation con &quot;Series No.&quot;</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Squash Player" src="/learning/assets/images/bc-posting-image-7-e8ed5cf18dffca2e45e2eef33630782b.png" width="615" height="345" class="img_ev3q"></p>
<p>Aggiungere ora il codice per la gestione del numeratore:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token class-name">Code</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">trigger</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">OnValidate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">xRec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SquashSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                NoSeriesMgt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TestManual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquashSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Squash Player Nos.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;No. Series&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">TRIGGER</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">OnInsert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SquashSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SquashSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Squash Player Nos.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            NoSeriesMgt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">InitSeries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquashSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Squash Player Nos.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">xRec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No. Series&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0D</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;No. Series&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Nella tabella <code>Contact Business Relation</code> campo <code>Link to Table</code> aggiungere <code>Squash Player</code> + la TableRelation nel campo <code>No.</code></li>
<li>Aggiungere il campo <code>Bus. Rel. Code for Squash Player</code> in <code>Marketing Setup</code></li>
</ul>
<p>Adesso possiamo sviluppare la funzione per creare il Player a partire dal contatto:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// prendendo esempio dalla CreateCustomer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateSquashPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">Type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Type</span><span class="token operator" style="color:#393A34">::</span><span class="token plain">Person</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RMSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RMSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Bus. Rel. Code for Squash Pl.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CLEAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquashPlayer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SquashPlayer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">INSERT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Contact No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> Cont</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Business Relation Code&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> RMSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Bus. Rel. Code for Squash Pl.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Link to Table&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Link to Table&quot;</span><span class="token operator" style="color:#393A34">::</span><span class="token string" style="color:#e3116c">&quot;Squash Player&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SquashPlayer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">INSERT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UpdateCustVendBank</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">UpdateSquashPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Cont</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">ContBusRel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MESSAGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Text009</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">SquashPlayer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLECAPTION</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">SquashPlayer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// prendendo esempio dalla UpdateCustomer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UpdateSquashPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> SquashPlayer </span><span class="token keyword" style="color:#00009f">DO</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GET</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        xRecRef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GETTABLE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquashPlayer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NoSerie </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;No. Series&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TRANSFERFIELDS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Cont</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> ContBusRel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;No. Series&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> NoSerie</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">MODIFY</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RecRef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GETTABLE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquashPlayer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ChangeLogMgt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">LogModification</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RecRef</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">xRecRef</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="processo-di-prenotazione">Processo di prenotazione<a href="#processo-di-prenotazione" class="hash-link" aria-label="Link diretto a Processo di prenotazione" title="Link diretto a Processo di prenotazione">​</a></h2>
<p>Per costruire un flusso di registrazione prenderemo esempio dalla gestione delle <code>Resource</code> in Business Central, questo perchè le risorse hanno un processo semplice da capire come per gli item, ma a differenza di questi sono anche più semplici da utilizzare.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="struttura">Struttura<a href="#struttura" class="hash-link" aria-label="Link diretto a Struttura" title="Link diretto a Struttura">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="squash-court">Squash Court<a href="#squash-court" class="hash-link" aria-label="Link diretto a Squash Court" title="Link diretto a Squash Court">​</a></h4>
<p>Questa tabella master è simile alle risorse, quindi possiamo andare a copiare le sue funzionalità.
Utilizzeremo però il numero di serie inserito nella Squash Setup.</p>
<p><img decoding="async" loading="lazy" alt="Squash Court" src="/learning/assets/images/bc-posting-image-cb400f7a4ac961727725634d612bde13.png" width="615" height="125" class="img_ev3q"></p>
<p>Come obiettivo dell&#x27;esercizio vogliamo essere in grado di tenere traccia delle prenotazioni.
Creeremo quindi uno Squash Journal per creare movimenti di prenotazioni che potranno essere fatturati.
Un journal ha bisogno di una struttura complessa, per questo la creeremo a partire da una già esistente. Copieremo quindi le <code>Resource Journals</code>:</p>
<p><img decoding="async" loading="lazy" alt="Resource Journals" src="/learning/assets/images/bc-posting-image-1-2ecdcecb0c5bdeb65c221403bd658acf.png" width="798" height="454" class="img_ev3q"></p>
<p>Tutti i journal hanno la stessa struttura:</p>
<ul>
<li>il Template, Batch e la Register table sono quasi sempre uguali in ogni struttura</li>
<li>la Journal Line e la Ledger Entry invece contengono campi specifici di funzione</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="journal-template">Journal Template<a href="#journal-template" class="hash-link" aria-label="Link diretto a Journal Template" title="Link diretto a Journal Template">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Journal Template" src="/learning/assets/images/bc-posting-image-2-4e910312d9776e6b915fb3450e0b0c08.png" width="615" height="348" class="img_ev3q"></p>
<ul>
<li><strong>Name</strong>: Il nome univoco del template. È possibile definire tanti modelli quanti ne sono necessari, ma di solito un Template per Page ID e uno per Recurring sono sufficienti. Se si desiderano journals con diversi codici di origine, è necessario avere più modelli.</li>
<li><strong>Description</strong></li>
<li><strong>Page ID</strong>: Per alcune journals, servono più oggetti UI. Per esempio, le General Journals hanno una pagina sia per la banca che per i pagamenti.</li>
<li><strong>Source Code</strong>: un codice di traccia per tutte le registrazioni fatte tramite questo template.</li>
<li><strong>Reason Code</strong>: simile al source code.</li>
<li><strong>Recurring</strong>: Ogni volta che si registrano righe da un registro ricorrente, vengono create automaticamente nuove righe con una data di registrazione definita nella formula di data ricorrente</li>
<li><strong>No. Series</strong>: il document no. nella journal line viene automaticamente popolato con un nuovo numero da questa serie di numeri</li>
</ul>
<p>Vedere esempio pagina <code>Def. registrazioni COGE</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="journal-batch">Journal Batch<a href="#journal-batch" class="hash-link" aria-label="Link diretto a Journal Batch" title="Link diretto a Journal Batch">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Journal Batch" src="/learning/assets/images/bc-posting-image-3-a4e50a0147bb8905b08aeb1489c97e40.png" width="615" height="232" class="img_ev3q"></p>
<ul>
<li><strong>Journal Template Name</strong>: collegamento al Template</li>
<li><strong>Name</strong> : Codice del Batch</li>
<li><strong>Description</strong></li>
<li><strong>Reason Code</strong>: Se inserito, sovrascrive quello del Template</li>
<li><strong>No. Series</strong>: Se inserito, sovrascrive quello del Template</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="register">Register<a href="#register" class="hash-link" aria-label="Link diretto a Register" title="Link diretto a Register">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Register" src="/learning/assets/images/bc-posting-image-4-42f2ca95dc3fbc35b97942faca073d38.png" width="615" height="236" class="img_ev3q"></p>
<ul>
<li><strong>No.</strong>: Campo automaticamente incrementato per ogni transazione del journal.</li>
<li><strong>From Entry No.</strong>: La prima Ledger Entry creata con questa transizione.</li>
<li><strong>To Entry No.</strong>: L&#x27;ultima Ledger Entry creata con questa transizione.</li>
<li><strong>Creation Date</strong>: Compilata sempre con la data reale di quando è stata registrata la transizione.</li>
<li><strong>User ID</strong>: L&#x27;ID dell&#x27;utente che ha registrato la transazione</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="journal-line">Journal Line<a href="#journal-line" class="hash-link" aria-label="Link diretto a Journal Line" title="Link diretto a Journal Line">​</a></h4>
<p>Le journal line hanno un numero di campi obbligatori che sono richiesti per tutti i journals e alcuni campi che sono richiesti per le sue funzionalità di design.
Il processo di reservation richiede di conoscere il codice del campo da Squash, la data e l&#x27;ora della prenotazione. Salveremo anche per quanto tempo vogliono giocare e il codice del giocatore.
Per la fatturazione abbiamo bisogno del prezzo da fatturare e il costo.</p>
<p><img decoding="async" loading="lazy" alt="Journal Line" src="/learning/assets/images/bc-posting-image-5-cc3bcabe2a33528d23c77d024d993ee1.png" width="615" height="290" class="img_ev3q"></p>
<ul>
<li><strong>Journal Template Name</strong>: collegamento al Template.</li>
<li><strong>Line No.</strong> : Ogni Journal ha, virtualmente, un numero illimitato di righe. Questo numero è automaticamente incrementato di 10000, per poter creare delle righe in mezzo.</li>
<li><strong>Entry Type</strong>: Reservation o Invoice.</li>
<li><strong>Document No.</strong>: Questo numero può essere dato al giocatore come numero della prenotazione. Quando il tipo del movimento è fattura allora è il numero della fattura.</li>
<li><strong>Posting Date</strong>: è la data della prenotazione, ma quando il movimento è fattura allora può essere la data della fattura.</li>
<li><strong>Squash Player No.</strong>: chi ha fatto la prenorazione.</li>
<li><strong>Squash Court No.</strong>: il campo da utilizzare.</li>
<li><strong>Description</strong>: aggiornamento automaticamente con il numero del campo, la data e l&#x27;ora della prenotazione, può essere modificata dall&#x27;utente.</li>
<li><strong>Reservation Date</strong>: data della prenotazione.</li>
<li><strong>From Time</strong>: Ora di inizio della prenotazione. Possiamo inserire solo ore intere o mezz&#x27;ore.</li>
<li><strong>To Time</strong>: Ora di fine della prenotazione.  Possiamo inserire solo ore intere o mezz&#x27;ore. Inserita in automatico quando inseriamo una quantità.</li>
<li><strong>Quantity</strong>: Numero di ore di gioco, possiamo inserire solo unità di 0.5, è calcolata in autoamtico quando i campi time sono inseriti.</li>
<li><strong>Unit Cost</strong>: Il costo di gestione del campo per un&#x27;ora di gioco.</li>
<li><strong>Total Cost</strong>: Costo della prenotazione.</li>
<li><strong>Unit Price</strong>: Prezzo della fattura per ora per la prenotazione, questo dipende se il giocatore è un membro del circolo o no.</li>
<li><strong>Total Price</strong>: Prezzo totale della fattura per questa prenotazione.</li>
<li><strong>Applies-to Entry No.</strong>: Quando una prenotazione è fatturata, questo campo contiene il numero Squash Entry No. della prenotazione.</li>
<li><strong>Source Code</strong>: Ereditato dalla tabella batch o template e usato in fase di registrazione.</li>
<li><strong>Chargeable</strong>: Quando questa opzione è usata, non ci sarà una fattura per questa prenotazione.</li>
<li><strong>Journal Batch Name</strong>: Collegamento al Batch.</li>
<li><strong>Reason Code</strong>: Ereditato dalla tabella batch o template e usato in fase di registrazione.</li>
<li><strong>Bill-to Customer No.</strong>: Determina chi paga per la prenotazione. Ereditato dallo Squash Player.</li>
<li><strong>Gen. Bus. Posting Group</strong>: la combinazione di general business e product posting group determina il Conto COGE (contabilità generale) su cui fare il giroconto quando fattureremo la prenotazione. Gen. Bus. Posting Group è ereditato dal bill-to customer.</li>
<li><strong>Gen. Prod. Posting Group</strong>: Ereditato dallo squash court.</li>
<li><strong>External Document No.</strong>: Quando un giocatore vuole che ci annotiamo un numero di riferimento.</li>
<li><strong>Recurring Method</strong>: Quando il registro è un registro ricorrente, è possibile utilizzare questo campo per determinare se il campo dell&#x27;importo viene cancellato dopo la registrazione delle righe.</li>
<li><strong>Recurring Frequency</strong>: Questo campo determina la nuova data di registrazione dopo che le righe ricorrenti sono state registrate.</li>
<li><strong>Posting No. Series</strong>: Quando il template ha un posting no. series, lo si utilizza per popolare questo campo quando si registra.</li>
</ul>
<p>Prima di partire con il processo di registrazione dobbiamo ancora fare in modo che:</p>
<ul>
<li>I campi Time devono essere calcolati per non inserire valori errati</li>
<li>Lo Unit Price deve essere calcolato</li>
<li>I campi Unit Cost, Posting groups, and Bill-to Customer No. devono essere ereditati</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="time-calculation">Time calculation<a href="#time-calculation" class="hash-link" aria-label="Link diretto a Time calculation" title="Link diretto a Time calculation">​</a></h4>
<p>Vogliamo specificare solo il tempo di inizio e fine. Il campo da squash può essere usato solo in blocchi da 30 minuti. Il campo quantità dovrebbe essere calcolato sulla base dei tempi inseriti e vice versa. Per farlo creeremo una nuova tabella con i tempi di inizio e fine permessi. Questa tabella avrà solo due campi come in figura:</p>
<p><img decoding="async" loading="lazy" alt="Time calculation" src="/learning/assets/images/bc-posting-image-8-d63e78e9095ff3fde16a2d54c4c92850.png" width="615" height="170" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Time calculation 2" src="/learning/assets/images/bc-posting-image-9-e669df093301c4f210ed9361dcb6b57e.png" width="640" height="125" class="img_ev3q"></p>
<p>I campi time nella journal avranno una relazione con la tabella per prevenire che l&#x27;utente inserisca valori non permessi.
Ora inseriamo del codice che calcoli la quantità:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// campo From Time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">trigger</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">OnValidate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CalcQty</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// campo To Time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">trigger</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">OnValidate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CalcQty</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CalcQty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;From Time&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> 0T</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;To Time&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> 0T</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;To Time&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;From Time&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FIELDERROR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;To Time&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ResTime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SETFILTER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Reservation Time&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&gt;=%1&amp;&lt;%2&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;From Time&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;To Time&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ResTime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">CALCSUMS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Duration</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VALIDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Quantity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ResTime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Duration</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="price-management">Price Management<a href="#price-management" class="hash-link" aria-label="Link diretto a Price Management" title="Link diretto a Price Management">​</a></h4>
<p>Questo scenario potrebbe essere più complesso, ma al momento gestiremo solo due campi sulla tabella Squash Court che ci indica il prezzo per i Member e not Member.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="inherited-data">Inherited data<a href="#inherited-data" class="hash-link" aria-label="Link diretto a Inherited data" title="Link diretto a Inherited data">​</a></h4>
<p>Aggiungiamo i seguenti campi presi dalla Resource table alla nostra Squash Court:</p>
<p><img decoding="async" loading="lazy" alt="Inherited data" src="/learning/assets/images/bc-posting-image-10-d4b5c760231d208b37dfdf86d54bee88.png" width="615" height="282" class="img_ev3q"></p>
<p>Sono stati aggiunti i campi Unit Code, Unit Price, Gen. Prod. Posting Group, and VAT Prod. Posting Group.
Adesso nel campo &quot;Squash Court No.&quot; della Journal Line andiamo ad inserire il validate:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// campo Squash Court No. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">trigger</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">OnValidate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> SquashCourt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GET</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Squash Court No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Description </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SquashCourt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Description</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;Unit Cost&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SquashCourt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Unit Cost&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;Gen. Prod. Posting Group&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SquashCourt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Gen. Prod. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FindSquashPlayerPrice</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// trovare il prezzo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Gestiamo l&#x27;ereditarietà del campo Bill-to Customer No. dallo squash player e del campo Gen. Bus. Posting Group.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="posting-process">Posting process<a href="#posting-process" class="hash-link" aria-label="Link diretto a Posting process" title="Link diretto a Posting process">​</a></h3>
<p>Ora dobbiamo implementare il posting code, prendendo esempio dalle codeunit delle Resource:</p>
<p><img decoding="async" loading="lazy" alt="The posting process" src="/learning/assets/images/bc-posting-image-11-32e6a187aac07841ac602135c963e9d3.png" width="613" height="134" class="img_ev3q"></p>
<p>La filosofia di Microsoft Business Central è semplice: <em>Test near, Test far, Do-it, Clean up</em></p>
<p>Che significa:</p>
<ol>
<li>Test near: Dobbiamo testare i campi nella journal line table</li>
<li>Test far: Leggiamo i dati delle tabelle esterne per vedere se tutto è ok</li>
<li>Do-it: registriamo le righe</li>
<li>Clean up: eliminiamo i dati dalla journal table.</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-line">Check line<a href="#check-line" class="hash-link" aria-label="Link diretto a Check line" title="Link diretto a Check line">​</a></h4>
<p>Possiamo vedere chiaramente che i campi nella nostra tabella sono prima controllati e poi c&#x27;è la validazione delle date (e poi ci sarebbe il controllo delle dimensioni).</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RunCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> SquashJnlLine </span><span class="token keyword" style="color:#00009f">DO</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> EmptyLine </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">EXIT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Squash Player No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Squash Court No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Gen. Prod. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;From Time&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;To Time&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Reservation Date&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Bill-to Customer No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Entry Type&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Entry Type&quot;</span><span class="token operator" style="color:#393A34">::</span><span class="token plain">Invoice </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Applies-to Entry No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Applies-to Entry No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Entry Type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Entry Type&quot;</span><span class="token operator" style="color:#393A34">::</span><span class="token plain">Invoice</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> NORMALDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FIELDERROR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">Text000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AllowPostingFrom </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> 0D</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AllowPostingTo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> 0D</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="post-line">Post line<a href="#post-line" class="hash-link" aria-label="Link diretto a Post line" title="Link diretto a Post line">​</a></h4>
<p>Il codice del posting è semplice. I valori sono controllati e poi un record della Register è creato o aggiornato, infine viene scritta la ledger.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> SquashJnlLine </span><span class="token keyword" style="color:#00009f">DO</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> EmptyLine </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">EXIT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlCheckLine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RunCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquashJnlLine</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TempJnlLineDim</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> NextEntryNo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LOCKTABLE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">FIND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;+&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                NextEntryNo </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Entry No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            NextEntryNo </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> NextEntryNo </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LOCKTABLE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">FIND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;+&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INIT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token operator" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INSERT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;To Entry No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> NextEntryNo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashReg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">MODIFY</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashPlayer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GET</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Squash Player No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashPlayer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Blocked</span><span class="token punctuation" style="color:#393A34">,</span><span class="token boolean" style="color:#36acaa">FALSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GenPostingSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Gen. Bus. Posting Group&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Gen. Bus. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GenPostingSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Gen. Prod. Posting Group&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Gen. Prod. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            GenPostingSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GET</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Gen. Bus. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Gen. Prod. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INIT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Entry Type&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Entry Type&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Document No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No. Series&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Posting No. Series&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INSERT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="processo-di-fatturazione">Processo di fatturazione<a href="#processo-di-fatturazione" class="hash-link" aria-label="Link diretto a Processo di fatturazione" title="Link diretto a Processo di fatturazione">​</a></h2>
<p>L&#x27;ultimo step da fare è il processo di fatturazione. Utilizzeremo il reparto standard delle vendite.
Per la nostra applicazione dobbiamo crearo il documento di fattura e assicurarci che in fase di registrazione la nostra applicazione di squash venga aggiornata.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fattura">Fattura<a href="#fattura" class="hash-link" aria-label="Link diretto a Fattura" title="Link diretto a Fattura">​</a></h3>
<p>Dovremmo creare una funzione che combini le prenotazioni evase in fatture.
La funzione dovrà ciclare tra le Squash ledger entry con entry type reservation e open=yes, ordinate per Open, Entry Type, Bill-To Customer No., Reservation Date e dovrà creare una fattura per ogni Bill-to Customer No. incontrato.
Per ogni Squash Ledger Entry creeremo una sales line.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sales-header">Sales Header<a href="#sales-header" class="hash-link" aria-label="Link diretto a Sales Header" title="Link diretto a Sales Header">​</a></h4>
<p>The code to create a sales header looks like this:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateSalesHdr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CLEAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SalesHdr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetHideValidationDialog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document Type&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document Type&quot;</span><span class="token operator" style="color:#393A34">::</span><span class="token plain">Invoice</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document Date&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> WORKDATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> WORKDATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">VALIDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Sell-to Customer No.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SquashLedgerEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Bill-to Customer No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">INSERT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NextLineNo </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CounterOK </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> CounterOK </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sales-line">Sales Line<a href="#sales-line" class="hash-link" aria-label="Link diretto a Sales Line" title="Link diretto a Sales Line">​</a></h4>
<p>Codice per creare una sales line. Da notare che bisogna aggiungere il campo &quot;Applies-to Squash Entry No.&quot; alla tabella sales line.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateLn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> SquashLedgerEntry </span><span class="token keyword" style="color:#00009f">DO</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GenPstSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GET</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Gen. Bus. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Gen. Prod. Posting Group&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GenPstSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Sales Account&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INIT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document Type&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document Type&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SalesHdr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Line No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> NextLineNo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;System-Created Entry&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">Type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">Type</span><span class="token operator" style="color:#393A34">::</span><span class="token string" style="color:#e3116c">&quot;G/L Account&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">VALIDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;No.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GenPstSetup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Sales Account&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Description </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> Description</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">VALIDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Quantity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Quantity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">VALIDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Unit Price&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Unit Price&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">VALIDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Unit Cost (LCY)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Unit Cost&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Applies-to Squash Entry No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Entry No.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">INSERT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NextLineNo </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> NextLineNo </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Quando aggiungi campi alle tabelle documentali di vendita o acquista, assicurati di aggiungere gli stessi campi anche alle tabelle equialenti registrate, con lo stesso numero di campo. In questo modo l&#x27;informazione viene copiata anche nei dati di storico tramite la funzione TRANSFERFIELDS.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dialog">Dialog<a href="#dialog" class="hash-link" aria-label="Link diretto a Dialog" title="Link diretto a Dialog">​</a></h4>
<p>Se ci sono molte fatture combinate da creare la funzione potrebbe impiegare molto tempo, potrebbe essere utile mostrare una progress bar all&#x27;utente. Business Central ha una struttura standard per farlo.
Il codice seguente mostra il Bill-to Customer No. che si sta processando e la barra che va da 1 a 100%.
Lo calcoleremo tramite un counter. Alla fine mostriamo un messaggio con il numero delle fatture create e il numero delle Squash Ledger Entry processate.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Progress</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Dialog</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProgressMsg</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Label</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Creating Invoices for #1######################\Processing... #2######&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Text001</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Label</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Created %1 invoices, %2 Squash Entry processed&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CounterTotal </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SquashLedEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Count</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> SquashLedEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Findset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Progress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ProgressMsg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">repeat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Counter </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> Counter </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Progress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;Bill-to Customer No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Progress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">ROUND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Counter </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> CounterTotal </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">until</span><span class="token plain"> SquashLedEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Progress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Text001</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">CounterOK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">CounterTotal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Le costanti label con i valori #N##### consentono di mostrare e aggiornare un testo. Il numero di # danno la dimensione del valore.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="posting-process-1">Posting process<a href="#posting-process-1" class="hash-link" aria-label="Link diretto a Posting process" title="Link diretto a Posting process">​</a></h3>
<p>Ora siamo pronti per fare le modifiche necessarie al processo di posting della fattura di vendita.
La registrazione di un documento di vendita viene fatto usando una singola codeunit di registrazione e altri oggetti di aiuto:</p>
<ul>
<li>Codeunit 80: La procedura di registrazione che andremo a modificare.</li>
<li>Codeunit 81: codeunit chiamata dall&#x27;interfaccia utente e ha un dialog se l&#x27;utente vuole la spedizione, fattura o entrambe.</li>
<li>Codeunit 82: cdu 81 + stampa un report</li>
</ul>
<p>Modificheremo la codeunit 80. Vediamo come la codeunit è strutturata sulla base della strategia: Test Near, Test Far, Do it and Cleanup.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">internal</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RunWithCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> SalesHeader2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Record</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Sales Header&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CheckAndUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SalesHeader</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProcessPosting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SalesHeader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SalesHeader2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TempDropShptPostBuffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TempServiceItem2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TempServiceItemComp2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CustLedgEntry</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> EverythingInvoiced</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FinalizePosting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SalesHeader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> EverythingInvoiced</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TempDropShptPostBuffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La modifica la faremo collegandoci ad un evento che viene lanciato quando le righe vengono gestite:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Squash Journal Line</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> SalesLine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Applies-to Squash Entry No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PostSquashJnlLn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">PostSquashJnlLn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> SalesHeader </span><span class="token keyword" style="color:#00009f">DO</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OldSquashLedEnt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GET</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SalesLine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Applies-to Squash Entry No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OldSquashLedEnt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Open</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OldSquashLedEnt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TESTFIELD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Bill-to Customer No.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bill-to Customer No.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INIT</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Reason Code&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Reason Code&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Document No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> GenJnlLineDocNo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;External Document No.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> GenJnlLineExtDocNo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Quantity </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">SalesLine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Qty. to Invoice&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Source Code&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SrcCode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Chargeable </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlLn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;Posting No. Series&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Posting No. Series&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashJnlPostLine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RunWithCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SquashJnlLn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TempJnlLineDim</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La funzione va a prendere la squash ledger entry collegata, testa se è ancora aperta e se il Bill-to Customer No. non sia cambiato.
Quindi popoliamo la Squash Journal con le informazioni corrette e facciamo partire la registrazione.
Da notare che la journal line non viene inserita nel database in questo processo. Questo viene fatto per ragioni di performance e concorrenza. Neanche i Validate sono stati utilizzati, questo rende molto chiaro capire cosa succede.</p>
<p>Esempio di Squash Entries post registrazione di vendita:
<img decoding="async" loading="lazy" alt="Squash Entries Posted" src="/learning/assets/images/bc-posting-sq-posted-a2f1b39d45dac143fba0282266bc75b9.png" width="980" height="125" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="trova-movimenti">Trova Movimenti<a href="#trova-movimenti" class="hash-link" aria-label="Link diretto a Trova Movimenti" title="Link diretto a Trova Movimenti">​</a></h3>
<p>Parte aggiuntiva e opzionale dell&#x27;esercizio.</p>
<p>La nostra app è quasi completa, ora potremmo avere la necessita di navigare questi movimenti a partire dalla fattura, per farla dobbiamo integrare la funzione &quot;Trova Movimenti&quot; per trovare anche le nostre Squash Ledger Entry.
Abbiamo bisogno di agganciarci a due eventi della pagina 344.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="findrecords">FindRecords<a href="#findrecords" class="hash-link" aria-label="Link diretto a FindRecords" title="Link diretto a FindRecords">​</a></h4>
<p>La funzione che ricerca nel database trovando tutte le possibili combinazioni di document no. e posting date. Ci collegheremo ad un evento al suo interno.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Evento</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">procedure OnAfterNavigateFindRecords(var DocumentEntry: Record &quot;Document Entry&quot;; DocNoFilter: Text; PostingDateFilter: Text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Navigate: Page Navigate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">begin </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IF SquashLedgEntry.READPERMISSION THEN BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry.RESET;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry.SETCURRENTKEY(&quot;Document No.&quot;, &quot;Posting Date&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry.SETFILTER(&quot;Document No.&quot;,DocNoFilter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry.SETFILTER(&quot;Posting Date&quot;,PostingDateFilter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Navigate.InsertIntoDocEntry(DocumentEntry, DATABASE::&quot;Squash Ledger Entry&quot;, 0, SquashLedgEntry.TABLECAPTION,SquashLedgEntry.COUNT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    END;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La funzione controlla se abbiamo i permessi per leggere la Squash Ledger Entry, se non li abbiamo non verrà mostrata. Il filtraggio viene fatto tramite Document No. e Posting Date. Alla fine viene inserito il risultato di quanti record abbiamo trovato.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="showrecords">ShowRecords<a href="#showrecords" class="hash-link" aria-label="Link diretto a ShowRecords" title="Link diretto a ShowRecords">​</a></h4>
<p>La seconda funziona da modificare, viene attivata quando proviamo a navigare i record trovati.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Evento</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">OnAfterNavigateShowRecords</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TableID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Integer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> DocNoFilter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Text</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> PostingDateFilter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> TableID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">DATABASE</span><span class="token operator" style="color:#393A34">::</span><span class="token string" style="color:#e3116c">&quot;Squash Ledger Entry&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SETCURRENTKEY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Document No.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SETFILTER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Document No.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">DocNoFilter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SETFILTER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Posting Date&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">PostingDateFilter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">Page</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SquashLedgEntry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Come risultato finale dobbiamo ottenere:</p>
<p><img decoding="async" loading="lazy" alt="Navigate" src="/learning/assets/images/bc-posting-navigate-a78c710cd8b55ac2026054fffefdc042.png" width="426" height="480" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pagina del documento"><a class="pagination-nav__link pagination-nav__link--prev" href="/learning/docs/business-central/posting/theory"><div class="pagination-nav__sublabel">Precedente</div><div class="pagination-nav__label">Teoria</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/learning/docs/category/api"><div class="pagination-nav__sublabel">Successivo</div><div class="pagination-nav__label">API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#analisi" class="table-of-contents__link toc-highlight">Analisi</a></li><li><a href="#relationship-management" class="table-of-contents__link toc-highlight">Relationship Management</a></li><li><a href="#processo-di-prenotazione" class="table-of-contents__link toc-highlight">Processo di prenotazione</a><ul><li><a href="#struttura" class="table-of-contents__link toc-highlight">Struttura</a></li><li><a href="#posting-process" class="table-of-contents__link toc-highlight">Posting process</a></li></ul></li><li><a href="#processo-di-fatturazione" class="table-of-contents__link toc-highlight">Processo di fatturazione</a><ul><li><a href="#fattura" class="table-of-contents__link toc-highlight">Fattura</a></li><li><a href="#posting-process-1" class="table-of-contents__link toc-highlight">Posting process</a></li><li><a href="#trova-movimenti" class="table-of-contents__link toc-highlight">Trova Movimenti</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/thomascristofaro/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/thomascristofaro/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cristofaro.dev/it/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thomas Cristofaro<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://learn.microsoft.com/it-it/training/browse/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Microsoft Learn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Thomas Cristofaro, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>