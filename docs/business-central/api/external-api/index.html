<!doctype html>
<html lang="it" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-business-central/api/external-api" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">API Esterne | Thomas Learning</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://thomascristofaro.github.io/learning/img/thomas.png"><meta data-rh="true" name="twitter:image" content="https://thomascristofaro.github.io/learning/img/thomas.png"><meta data-rh="true" property="og:url" content="https://thomascristofaro.github.io/learning/docs/business-central/api/external-api"><meta data-rh="true" property="og:locale" content="it"><meta data-rh="true" name="docusaurus_locale" content="it"><meta data-rh="true" name="docsearch:language" content="it"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="API Esterne | Thomas Learning"><meta data-rh="true" name="description" content="Le API esterne sono un modo per integrare Business Central con altri sistemi. Esse sono dei servizi esterni esposti tramite un endpoint HTTP richiamabile da un altro sistema, nel nostro caso da Business Central."><meta data-rh="true" property="og:description" content="Le API esterne sono un modo per integrare Business Central con altri sistemi. Esse sono dei servizi esterni esposti tramite un endpoint HTTP richiamabile da un altro sistema, nel nostro caso da Business Central."><link data-rh="true" rel="icon" href="/learning/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://thomascristofaro.github.io/learning/docs/business-central/api/external-api"><link data-rh="true" rel="alternate" href="https://thomascristofaro.github.io/learning/docs/business-central/api/external-api" hreflang="it"><link data-rh="true" rel="alternate" href="https://thomascristofaro.github.io/learning/docs/business-central/api/external-api" hreflang="x-default"><link rel="stylesheet" href="/learning/assets/css/styles.30a2b5c7.css">
<script src="/learning/assets/js/runtime~main.a29a1f3c.js" defer="defer"></script>
<script src="/learning/assets/js/main.6235cb7f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Passa al contenuto principale"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Passa al contenuto principale</a></div><nav aria-label="Principale" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Attiva/disattiva la barra di navigazione" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/learning/"><div class="navbar__logo"><img src="/learning/img/avatar-sign.png" alt="Learning Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/learning/img/avatar-sign.png" alt="Learning Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Learning</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/learning/docs/business-central/Introduzione/intro">Business Central</a><a class="navbar__item navbar__link" href="/learning/docs/power-platform/intro">Power Platform</a><a class="navbar__item navbar__link" href="/learning/docs/power-apps/intro">Power Apps</a></div><div class="navbar__items navbar__items--right"><a href="https://cristofaro.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Passa dalla modalità scura a quella chiara (currently modalità luce)" aria-label="Passa dalla modalità scura a quella chiara (currently modalità luce)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Torna indietro all&#x27;inizio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Barra laterale dei documenti" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/business-central/Introduzione/intro">Introduzione</a><button aria-label="Expand sidebar category &#x27;Introduzione&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/strumenti-di-sviluppo">Strumenti di sviluppo</a><button aria-label="Expand sidebar category &#x27;Strumenti di sviluppo&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/linguaggio-al">Linguaggio AL</a><button aria-label="Expand sidebar category &#x27;Linguaggio AL&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/oggetti">Oggetti</a><button aria-label="Expand sidebar category &#x27;Oggetti&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/registrazione">Registrazione</a><button aria-label="Expand sidebar category &#x27;Registrazione&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/learning/docs/category/api">API</a><button aria-label="Collapse sidebar category &#x27;API&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/docs/business-central/api/theory">Nozioni di base</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/docs/business-central/api/bc-api">BC API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/learning/docs/business-central/api/external-api">API Esterne</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/docs/business-central/copilot">Copilot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/docs/business-central/project-management">Project Management</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/learning/docs/category/business-functions">Business Functions</a><button aria-label="Expand sidebar category &#x27;Business Functions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collassa la barra laterale" aria-label="Collassa la barra laterale" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Briciole di pane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Pagina principale" class="breadcrumbs__link" href="/learning/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/learning/docs/category/api"><span itemprop="name">API</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">API Esterne</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Su questa pagina</button></div><div class="theme-doc-markdown markdown"><header><h1>API Esterne</h1></header>
<p>Le API esterne sono un modo per integrare Business Central con altri sistemi. Esse sono dei servizi esterni esposti tramite un endpoint HTTP richiamabile da un altro sistema, nel nostro caso da Business Central.</p>
<p>Per richiamare un&#x27;API esterna è necessario utilizzare delle tipologie di data type specifiche che permettono di gestire delle chiamate HTTP. L&#x27;AL supporta un insieme di classi HTTP per l&#x27;invio e la ricezione di dati dai servizi HTTP. Queste classi sono un&#x27;implementazione delle classi System.Net.Http del Framework .NET. Le classi disponibili sono:</p>
<ul>
<li>HttpClient</li>
<li>HttpContent</li>
<li>HttpHeaders</li>
<li>HttpRequestMessage</li>
<li>HttpResponseMessage</li>
</ul>
<p>Tutti i tipi HTTP sono oggetti by reference, non by value. Questo significa che quando si passa un oggetto HTTP a un metodo, si passa un riferimento all&#x27;oggetto, non una copia dell&#x27;oggetto.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classi-http">Classi HTTP<a href="#classi-http" class="hash-link" aria-label="Link diretto a Classi HTTP" title="Link diretto a Classi HTTP">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="httpclient">HttpClient<a href="#httpclient" class="hash-link" aria-label="Link diretto a HttpClient" title="Link diretto a HttpClient">​</a></h3>
<p>La classe HttpClient fornisce una base class per l&#x27;invio di richieste HTTP e la ricezione di risposte HTTP da una risorsa identificata da un URI. Metodi della classe:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>DefaultRequestHeaders()</td><td>Ottiene le intestazioni predefinite che vengono inviate con ogni richiesta.</td></tr><tr><td>SetBaseAddress(Uri)</td><td>Imposta l&#x27;indirizzo di base dell&#x27;URI usato per le richieste.</td></tr><tr><td>Get(Uri, HttpResponseMessage)</td><td>Invia una richiesta GET per ottenere la risorsa identificata dall&#x27;URI specificato.</td></tr><tr><td>Post(Uri, HttpContent, HttpResponseMessage)</td><td>Invia una richiesta POST all&#x27;URI specificato.</td></tr><tr><td>Put(Uri, HttpContent, HttpResponseMessage)</td><td>Invia una richiesta PUT all&#x27;URI specificato.</td></tr><tr><td>Delete(Uri, HttpResponseMessage)</td><td>Invia una richiesta DELETE all&#x27;URI specificato.</td></tr><tr><td>Send(HttpRequestMessage, HttpResponseMessage)</td><td>Invia una richiesta HTTP. Nella variabile HttpRequestMessage, si deve specificare l&#x27;URI e il verbo da usare.</td></tr><tr><td>Clear()</td><td>Imposta la variabile HttpClient sul valore predefinito.</td></tr><tr><td>Timeout()</td><td>Ottiene o imposta il tempo di attesa in secondi prima del timeout della richiesta. Il timeout è un valore intero.</td></tr></tbody></table>
<p>Quando si specifica un URI, è possibile usare due approcci. Il primo consiste nell&#x27;usare SetBaseAddress con la classe HttpClient per eseguire più richieste:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    responseMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpResponseMessage</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetBaseAddress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://jsonplaceholder.typicode.com/&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> responseMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Il secondo approccio è invece usato quando si richiedono i dati una sola volta. In tal caso, è possibile inserire l&#x27;URI completo nella funzione Get.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    responseMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpResponseMessage</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://jsonplaceholder.typicode.com/posts&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> responseMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="httpheaders">HttpHeaders<a href="#httpheaders" class="hash-link" aria-label="Link diretto a HttpHeaders" title="Link diretto a HttpHeaders">​</a></h3>
<p>La classe HttpHeaders contiene una raccolta di intestazioni e i relativi valori. Le intestazioni HttpHeaders vengono inviate con ogni richiesta e risposta. Sono usate per inviare informazioni supplementari sulla richiesta o sul modo in cui la risposta deve essere formattata per il client.</p>
<p>È possibile ottenere intestazioni HttpHeaders usando la proprietà DefaultRequestHeaders della classe HttpClient.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    headers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpHeaders</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpContent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    responseMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpResponseMessage</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    headers </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">DefaultRequestHeaders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    headers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Content-Type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;application-json&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://jsonplaceholder.typicode.com/posts&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                responseMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Metodi della classe:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>Add(Key, Value)</td><td>Imposta il valore specificato per il nome di intestazione fornito.</td></tr><tr><td>Clear()</td><td>Imposta la variabile HttpHeaders sul valore predefinito.</td></tr><tr><td>Contains(Key)</td><td>Verifica se una variabile HttpHeaders contiene una proprietà con la chiave specificata.</td></tr><tr><td>GetValues(Key, Array of Text)</td><td>Ottiene i valori per la chiave specificata. I valori vengono restituiti nella matrice di testo.</td></tr><tr><td>Remove(Key)</td><td>Rimuove la chiave e i valori correlati dall&#x27;oggetto HttpHeaders.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="httpresponsemessage">HttpResponseMessage<a href="#httpresponsemessage" class="hash-link" aria-label="Link diretto a HttpResponseMessage" title="Link diretto a HttpResponseMessage">​</a></h3>
<p>La classe HttpResponseMessage rappresenta un messaggio di risposta HTTP. Un messaggio di risposta è il risultato di un&#x27;azione HTTP (Get, Post, Put, Delete). La classe HttpResponseMessage contiene informazioni sulla risposta, come ad esempio lo stato della risposta, il contenuto e le intestazioni.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    responseMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpResponseMessage</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://jsonplaceholder.typicode.com/posts&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> responseMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Metodi della classe:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>Content()</td><td>Ottiene il contenuto (HttpContent) della risposta HTTP.</td></tr><tr><td>Headers()</td><td>Ottiene le intestazioni HTTP della richiesta HTTP.</td></tr><tr><td>HttpStatusCode()</td><td>Ottiene il codice di stato della risposta HTTP.</td></tr><tr><td>IsSuccessStatusCode()</td><td>Ottiene un valore che indica se la risposta HTTP ha avuto esito positivo.</td></tr><tr><td>ReasonPhrase()</td><td>Ottiene il motivo del codice di stato.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="httprequestmessage">HttpRequestMessage<a href="#httprequestmessage" class="hash-link" aria-label="Link diretto a HttpRequestMessage" title="Link diretto a HttpRequestMessage">​</a></h3>
<p>La classe HttpRequestMessage rappresenta un messaggio di richiesta HTTP, è la classe usata per inviare una richiesta.</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requestMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpRequestMessage</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    responseMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HttpResponseMessage</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requestMessage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Method</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requestMessage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetRequestUri</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://jsonplaceholder.typicode.com/posts&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requestMessage</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> responseMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Metodi della classe:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>Content()</td><td>Ottiene/imposta il contenuto della richiesta HTTP.</td></tr><tr><td>GetRequestUri()</td><td>Ottiene l&#x27;URI usato per la richiesta HTTP.</td></tr><tr><td>Method()</td><td>Ottiene o imposta il tipo di metodo. Specificare un verbo HTTP usato.</td></tr><tr><td>SetRequestUri(RequestUri)</td><td>Imposta l&#x27;URI usato per la richiesta HTTP.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="httpcontent">HttpContent<a href="#httpcontent" class="hash-link" aria-label="Link diretto a HttpContent" title="Link diretto a HttpContent">​</a></h3>
<p>La classe HttpContent rappresenta un body HTTP e gli headers del contenuto. È usata come corpo per inviare o ricevere informazioni. È possibile usare la proprietà Content nelle classe HttpRequestMessage (con una richiesta) o nella classe HttpResponseMessage (con una risposta). Metodi della classe:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>Clear()</td><td>Imposta l&#x27;oggetto HttpContent su un valore predefinito.</td></tr><tr><td>GetHeaders(HttpHeaders)</td><td>Ottiene le intestazioni HTTP del contenuto. Il risultato viene restituito nel parametro HttpHeaders.</td></tr><tr><td>ReadAs(Result)</td><td>Legge il contenuto nel testo o nel flusso fornito. Il risultato può essere di tipo Text o InStream.</td></tr><tr><td>WriteFrom(Value)</td><td>Imposta la variabile HttpContent sul testo o flusso fornito.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="esercizio-1">Esercizio 1<a href="#esercizio-1" class="hash-link" aria-label="Link diretto a Esercizio 1" title="Link diretto a Esercizio 1">​</a></h2>
<p>Si vuole testare l&#x27;API degli utenti del servizio <a href="https://jsonplaceholder.typicode.com" target="_blank" rel="noopener noreferrer">https://jsonplaceholder.typicode.com</a> che mette a disposizione degli esempi di API. Eseguire quindi i seguenti passaggi:</p>
<ol>
<li>Creare un&#x27;estensione della pagina lista clienti</li>
<li>Creare un pulsante chiamato &quot;Read User API&quot; che deve:</li>
<li>Contattare l&#x27;API degli <a href="https://jsonplaceholder.typicode.com/users" target="_blank" rel="noopener noreferrer">utenti</a> tramite una chiamata GET</li>
<li>Testare lo status code, la chiamata è andata a buon fine?<!-- -->
<ul>
<li>se no, allora lanciare un errore con il motivo del codice dello stato</li>
<li>se si, allora lanciare un messaggio con il testo del messaggio di risposta.</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="json">JSON<a href="#json" class="hash-link" aria-label="Link diretto a JSON" title="Link diretto a JSON">​</a></h2>
<p>AL in Business Central ha il supporto integrato per usare dati JSON. Queste classi vengono usate per il trasferimento dei dati e non come campi di una tabella. Queste classi sono un&#x27;implementazione delle classi System.Json di .NET Framework:</p>
<ul>
<li>JsonToken</li>
<li>JsonArray</li>
<li>JsonObject</li>
<li>JsonValue
Tutti i tipi JSON sono tipi di riferimento, non tipi di valore.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jsontoken">JsonToken<a href="#jsontoken" class="hash-link" aria-label="Link diretto a JsonToken" title="Link diretto a JsonToken">​</a></h3>
<p>L&#x27;oggetto JsonToken è un contenitore per tutti i dati JSON. Il valore predefinito di un JsonToken è NULL. JsonToken è la classe base per i tipi di dati JsonArray, JsonValue e JsonObject. Esempio di utilizz:</p>
<div class="language-al codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-al codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string" style="color:#e3116c">&quot;company&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;employees&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Marcy&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;salary&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8.95</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;John&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;salary&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Diana&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;salary&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.95</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">procedure</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetSalary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CompanyData</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">JsonToken</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> Employee</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Salary</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Decimal</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JPathExpr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Text</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SalaryToken</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">JsonToken</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JPathExpr </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$.company.employees[?(@.id==&#x27;&#x27;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> Employee </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;&#x27;)].salary&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CompanyData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SelectToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">JPathExpr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> salaryToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Salary </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> SalaryToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AsValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AsDecimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copia il codice negli appunti" title="Copia" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Metodi della classe:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>ReadFrom(Text/InStream)</td><td>Legge i dati JSON dal testo o dal flusso e li memorizza in una variabile JsonToken.</td></tr><tr><td>WriteTo(Text/OutStream)</td><td>Serializza e scrive i dati JSON dalla variabile JsonToken in un testo o flusso specifico.</td></tr><tr><td>SelectToken(JPath, JsonToken)</td><td>Seleziona una variabile JsonToken utilizzando un&#x27;espressione JPath.</td></tr><tr><td>IsArray</td><td>Indica se un JsonToken rappresenta un array JSON.</td></tr><tr><td>IsValue</td><td>Indica se un JsonToken rappresenta un valore JSON.</td></tr><tr><td>IsObject</td><td>Indica se un JsonToken rappresenta un oggetto JSON.</td></tr><tr><td>AsArray</td><td>Converte il valore contenuto in un JsonToken in un tipo di dati JsonArray.</td></tr><tr><td>AsValue</td><td>Converte il valore contenuto in un JsonToken in un tipo di dati JsonValue.</td></tr><tr><td>AsObject</td><td>Converte il valore contenuto in un JsonToken in un tipo di dati JsonObject.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jsonarray">JsonArray<a href="#jsonarray" class="hash-link" aria-label="Link diretto a JsonArray" title="Link diretto a JsonArray">​</a></h3>
<p>JsonArray è un contenitore per qualsiasi array JSON. Un JsonArray predefinito contiene un array JSON vuoto. Questo contenitore funziona più come un tipo di dati ListOf che come un array. Contiene quindi molti metodi simili ad una lista:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>Add(Value)</td><td>Aggiunge un nuovo valore alla fine del JsonArray. Questo valore può essere di tipo JsonToken, JsonObject, JsonArray, Boolean, Char, Byte, Integer, BigInteger, Decimal, Duration, String, Date, Time o DateTime.</td></tr><tr><td>Get(Index, JsonToken)</td><td>Recupera il valore corrispondente all&#x27;indice specificato nel JsonArray.</td></tr><tr><td>IndexOf(Value)</td><td>Restituisce la posizione dell&#x27;indice di un valore specificato.</td></tr><tr><td>Insert(Index, Value)</td><td>Inserisce il valore nella posizione specificata nell&#x27;array, spostando tutti i valori a destra di una posizione.</td></tr><tr><td>RemoveAt(Index)</td><td>Rimuove il token corrispondente all&#x27;indice specificato.</td></tr><tr><td>Set(Index, Value)</td><td>Sostituisce il valore alla posizione specificata con un nuovo valore.</td></tr><tr><td>RemoveAll()</td><td>Rimuove tutti gli elementi figlio dall&#x27;array specificato.</td></tr><tr><td>Count</td><td>Ottiene il numero di elementi nel JsonArray.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jsonobject">JsonObject<a href="#jsonobject" class="hash-link" aria-label="Link diretto a JsonObject" title="Link diretto a JsonObject">​</a></h3>
<p>JsonObject è un contenitore per tutti gli oggetti JSON. Un JsonObject predefinito contiene un oggetto JSON vuoto. Metodi specifici per gli oggetti JSON:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>Add(Value)</td><td>Aggiunge una nuova proprietà a un JsonObject.</td></tr><tr><td>Contains(Key)</td><td>Verifica se un JsonObject contiene una proprietà con una determinata chiave.</td></tr><tr><td>Get(Key, Value)</td><td>Recupera il valore di una proprietà con una determinata chiave da un JsonObject.</td></tr><tr><td>Remove(Key)</td><td>Rimuove la proprietà con la chiave specificata dall&#x27;oggetto.</td></tr><tr><td>Replace(Key, Value)</td><td>Sostituisce il valore della proprietà con la chiave specificata con il nuovo valore.</td></tr><tr><td>RemoveAll()</td><td>Rimuove tutte le proprietà dall&#x27;oggetto specificato.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jsonvalue">JsonValue<a href="#jsonvalue" class="hash-link" aria-label="Link diretto a JsonValue" title="Link diretto a JsonValue">​</a></h3>
<p>JsonValue è un contenitore per tutti i valori JSON fondamentali. Un JsonValue predefinito è impostato sul valore JSON di NULL. Metodi specifici per i valori JSON:</p>
<table><thead><tr><th>Metodo</th><th>Descrizione</th></tr></thead><tbody><tr><td>IsNull()</td><td>Indica se JsonValue contiene il valore JSON di NULL.</td></tr><tr><td>Metodi As</td><td>Converte il valore di un JsonValue in un tipo di dati specifico. I metodi includono AsBoolean(), AsByte(), AsChar(), AsInteger(), AsDecimal(), AsCode(), AsText(), AsDate() e AsDateTime().</td></tr><tr><td>SetValue(Value)</td><td>Imposta i contenuti della variabile JsonValue sulla rappresentazione JSON del valore specificato.</td></tr><tr><td>SetValueToNull()</td><td>Imposta i contenuti della variabile JsonValue sulla rappresentazione JSON di NULL.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="esercizio-2">Esercizio 2<a href="#esercizio-2" class="hash-link" aria-label="Link diretto a Esercizio 2" title="Link diretto a Esercizio 2">​</a></h2>
<p>Partendo dall&#x27;esercizio 1, analizzare il JSON di risposta e inserire gli utenti nella tabella clienti.</p>
<ol>
<li>Convertire la risposta dal formato testo in un JSON</li>
<li>Leggere i singoli valori tramite le funzioni spiegate nei paragrafi precedenti</li>
<li>Compilare i campi di un record cliente con i valori presi dal JSON</li>
<li>Creare un campo Boolean &quot;API&quot; nella tabella clienti</li>
<li>Impostare il campo &quot;API&quot; dei record creati tramite chiamata API a true</li>
<li>Creare un pulsante per eliminare tutti i record clienti che hanno il campo &quot;API&quot;=true, in questo modo si possono fare più test con gli stessi dati e lasciare un ambiente pulito.</li>
</ol>
<p><a href="https://learn.microsoft.com/it-it/training/modules/access-rest-services/" target="_blank" rel="noopener noreferrer">Microsoft Learn</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pagina del documento"><a class="pagination-nav__link pagination-nav__link--prev" href="/learning/docs/business-central/api/bc-api"><div class="pagination-nav__sublabel">Precedente</div><div class="pagination-nav__label">BC API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/learning/docs/business-central/copilot"><div class="pagination-nav__sublabel">Successivo</div><div class="pagination-nav__label">Copilot</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#classi-http" class="table-of-contents__link toc-highlight">Classi HTTP</a><ul><li><a href="#httpclient" class="table-of-contents__link toc-highlight">HttpClient</a></li><li><a href="#httpheaders" class="table-of-contents__link toc-highlight">HttpHeaders</a></li><li><a href="#httpresponsemessage" class="table-of-contents__link toc-highlight">HttpResponseMessage</a></li><li><a href="#httprequestmessage" class="table-of-contents__link toc-highlight">HttpRequestMessage</a></li><li><a href="#httpcontent" class="table-of-contents__link toc-highlight">HttpContent</a></li></ul></li><li><a href="#esercizio-1" class="table-of-contents__link toc-highlight">Esercizio 1</a></li><li><a href="#json" class="table-of-contents__link toc-highlight">JSON</a><ul><li><a href="#jsontoken" class="table-of-contents__link toc-highlight">JsonToken</a></li><li><a href="#jsonarray" class="table-of-contents__link toc-highlight">JsonArray</a></li><li><a href="#jsonobject" class="table-of-contents__link toc-highlight">JsonObject</a></li><li><a href="#jsonvalue" class="table-of-contents__link toc-highlight">JsonValue</a></li></ul></li><li><a href="#esercizio-2" class="table-of-contents__link toc-highlight">Esercizio 2</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/thomascristofaro/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/thomascristofaro/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cristofaro.dev/it/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thomas Cristofaro<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://learn.microsoft.com/it-it/training/browse/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Microsoft Learn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Thomas Cristofaro, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>